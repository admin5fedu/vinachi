<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thư mời nhận việc</title>
    <!-- Thư viện Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        body {
            font-family: 'Times New Roman', Times, serif;
            line-height: 1.3;
            margin: 0;
            padding: 0;
            background: #f0f0f0;
            font-size: 11pt;
        }

        /* Khung chuẩn A4 */
        .document-container {
            width: 210mm;         /* đúng chuẩn ngang A4 */
            min-height: 297mm;    /* đúng chuẩn cao A4 */
            padding: 20mm;        /* margin 2cm */
            margin: 20px auto;
            background: white;
            box-shadow: 0 0 5px rgba(0,0,0,0.2);
            box-sizing: border-box;
        }

        @page {
            size: A4;
            margin: 0; /* padding đã nằm trong .document-container */
        }

        @media print {
            body {
                background: white !important;
            }
            .document-container {
                margin: 0 auto !important;
                box-shadow: none !important;
                border: none !important;
                page-break-after: always;
            }
            .no-print {
                display: none !important;
            }
        }

        .header-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }
        .header-table td {
            vertical-align: top;
        }

        .section-title {
            font-weight: bold;
            font-size: 18px;
            text-align: center;
            margin-bottom: 10px;
        }

        .section-heading {
            font-weight: bold;
            text-transform: uppercase;
            margin-top: 10px;
            margin-bottom: 5px;
        }

        .list-style-none {
            list-style-type: none;
            padding-left: 0;
        }
        .indent-1 {
            padding-left: 20px;
        }
        .mb-2 { margin-bottom: 6px; }
        .mb-1 { margin-bottom: 4px; }
    </style>
</head>
<body>

<!-- Nút thao tác -->
<div class="flex justify-end gap-2 p-4 no-print">
    <button onclick="printDocument()" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded">
        In
    </button>
    <button onclick="downloadExcel()" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">
        Xuất Excel
    </button>
    <button onclick="downloadPDF()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
        Xuất PDF
    </button>
</div>

<!-- Nội dung chính -->
<div class="document-container" id="documentContainer">
    <table class="header-table">
        <tr>
            <td style="width: 20%;">
                <img src="https://drive.google.com/thumbnail?id=12VL0Dxkj5d8xwLFVRslpHdtlWd4MHF5a" 
                     alt="VINACHI Logo" style="max-width: 100px; height: auto;">
            </td>
            <td style="width: 80%; text-align:left;">
                <h2 style="margin:0;font-size:16px;font-weight:bold;">CÔNG TY TNHH VINACHI VIỆT NAM</h2>
                <p style="margin:0;font-size:14px;font-style:italic;">Kim Thiều - Hương Mạc - Từ Sơn - Bắc Ninh</p>
            </td>
        </tr>
    </table>

    <div class="text-right mb-2">
        Bắc Ninh, ngày <span id="ngay_data"></span> tháng <span id="thang_data"></span> năm <span id="nam_data"></span>
    </div>

    <div class="section-title">THƯ MỜI NHẬN VIỆC</div>

    <p class="mb-2">
        Công ty TNHH Vinachi Việt Nam gửi đến Anh/chị <span id="ten_ung_vien_data" class="font-bold uppercase"></span> 
        thư mời hợp tác với nội dung như sau:
    </p>

    <h3 class="section-heading">I - THỜI GIAN VÀ ĐỊA ĐIỂM</h3>
    <ul class="list-style-none indent-1">
        <li>- <b>Lúc:</b> <span id="gio_data"></span>h<span id="phut_data"></span> ngày <span id="ngay_nhan_viec_data"></span>/<span id="thang_nhan_viec_data"></span>/<span id="nam_nhan_viec_data"></span></li>
        <li>- <b>Tại:</b> <span id="dia_diem_data"></span></li>
        <li>- <b>Vị trí công việc:</b> <span id="vi_tri_ung_tuyen_data"></span>, Phòng <span id="phong_ban_data"></span></li>
        <li>- <b>Thời gian làm việc:</b> <span id="thoi_gian_lam_viec_data"></span></li>
        <li>- <b>Thời gian thử việc:</b> <span id="thoi_gian_thu_viec_data"></span></li>
    </ul>

    <h3 class="section-heading">II - THU NHẬP</h3>
    <table class="w-full border-collapse border border-gray-400 mb-2 text-sm" id="incomeTable">
        <thead>
            <tr class="bg-gray-100 text-center font-bold">
                <th class="border p-2">Tổng thu nhập</th>
                <th class="border p-2">Lương CB</th>
                <th class="border p-2">Lương KPI</th>
                <th class="border p-2">Đàm phán</th>
                <th class="border p-2">PC chức vụ</th>
                <th class="border p-2">PC vùng miền</th>
                <th class="border p-2">PC khác</th>
                <th class="border p-2">Tổng từ lương</th>
                <th class="border p-2">Thưởng</th>
            </tr>
        </thead>
        <tbody>
            <tr class="text-center">
                <td id="tong_thu_nhap_data" class="border p-2 font-bold"></td>
                <td id="luong_cb_data" class="border p-2"></td>
                <td id="luong_kpi_data" class="border p-2"></td>
                <td id="dam_phan_data" class="border p-2"></td>
                <td id="pc_chuc_vu_data" class="border p-2"></td>
                <td id="phu_cap_vung_mien_data" class="border p-2"></td>
                <td id="phu_cap_khac_data" class="border p-2"></td>
                <td id="tong_thu_nhap_tu_luong_data" class="border p-2"></td>
                <td id="thuong_data" class="border p-2"></td>
            </tr>
        </tbody>
    </table>

    <p>- Nhận 100% lương trong quá trình thử việc (không có thưởng)</p>

    <h3 class="section-heading">III - CHẾ ĐỘ ĐÃI NGỘ</h3>
    <ul class="list-style-none indent-1">
        <li>- Bữa trưa tại công ty hoặc phụ cấp (700k - 1tr)</li>
        <li>- Nghỉ phép 12 ngày/năm, lễ tết theo luật, BHXH đầy đủ</li>
        <li>- Quà, thưởng ngày lễ, sinh nhật, hỗ trợ ốm đau</li>
        <li>- Thưởng lương tháng 13, 14 theo kết quả kinh doanh</li>
        <li>- Du lịch hàng năm, liên hoan 3 tháng/lần</li>
        <li id="ghi_chu_data"></li>
    </ul>

    <h3 class="section-heading">IV - THỦ TỤC NHẬN VIỆC</h3>
    <p>Mang theo hồ sơ: sơ yếu lý lịch, khai sinh, hộ khẩu, CCCD, bằng cấp, giấy xác nhận dân sự.</p>

    <p>Mọi thắc mắc liên hệ: P.HCNS Vinachi 0976.831.226 - hcns@vinachi.vn</p>

    <div class="flex justify-end mt-10 mr-8">
        <div class="text-center">
            <p class="font-bold">TM CÔNG TY TNHH VINACHI</p>
            <p class="font-bold mt-2">PHÒNG HCNS</p>
        </div>
    </div>
</div>

<script>
    function printDocument() { window.print(); }

    function downloadExcel() {
        const table = document.getElementById('incomeTable');
        let csv = [];
        const headers = Array.from(table.querySelectorAll('thead th')).map(th => th.innerText);
        csv.push(headers.join(','));
        table.querySelectorAll('tbody tr').forEach(row => {
            const rowData = Array.from(row.querySelectorAll('td')).map(td => td.innerText.trim());
            csv.push(rowData.join(','));
        });
        const blob = new Blob(["\uFEFF" + csv.join('\n')], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'Thu_nhap.csv';
        link.click();
    }

    async function downloadPDF() {
        const element = document.getElementById('documentContainer');
        const canvas = await html2canvas(element, { scale: 2, useCORS: true });
        const imgData = canvas.toDataURL('image/jpeg', 1.0);

        const pdf = new jspdf.jsPDF('p', 'mm', 'a4');
        const pdfWidth = 210, pdfHeight = 297;
        const imgProps = pdf.getImageProperties(imgData);
        const imgHeight = (imgProps.height * pdfWidth) / imgProps.width;

        pdf.addImage(imgData, 'JPEG', 0, 0, pdfWidth, imgHeight);
        pdf.save('Thu_moi_nhan_viec.pdf');
    }
</script>

</body>
</html>
