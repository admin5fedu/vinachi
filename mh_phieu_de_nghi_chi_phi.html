<script>
    // L·∫•y t·∫•t c·∫£ tham s·ªë t·ª´ URL
    const params = new URLSearchParams(window.location.search);
    const data = {};

    // L·∫•y s·ªë ti·ªÅn v√† ng√†y t·∫°o phi·∫øu
    const soTien = params.get('so_tien') || '';
    const ngayTaoPhieu = params.get('ngay_tao_phieu') || '';
    const loaiPhieu = params.get('loai_phieu') || 'CHI T·∫†M ·ª®NG';

    // X·ª≠ l√Ω ng√†y th√°ng
    if (ngayTaoPhieu) {
        const parts = ngayTaoPhieu.split('/');
        if (parts.length === 3) {
            data.ngay_tao_phieu_full = `ng√†y ${parts[0]} th√°ng ${parts[1]} nƒÉm ${parts[2]}`;
        }
    }

    // X·ª≠ l√Ω s·ªë ti·ªÅn th√†nh ch·ªØ
    if (soTien) {
        const soTienClean = soTien.replace(/\./g, '');
        data.bang_chu = convertNumberToVietnamese(soTienClean);
    }

    // X·ª≠ l√Ω lo·∫°i phi·∫øu
    data.loai_phieu = loaiPhieu.toUpperCase();

    // L·∫•y t·∫•t c·∫£ tham s·ªë c√≤n l·∫°i
    for (const [key, value] of params.entries()) {
        const decodedValue = decodeURIComponent(value).replace(/\n/g, "<br/>");
        data[key] = decodedValue;
    }

    // üîπ Ch·ªâ thay th·∫ø trong ph·∫ßn n·ªôi dung t√†i li·ªáu (kh√¥ng replace to√†n body)
    const container = document.getElementById("document-content");
    container.innerHTML = container.innerHTML.replace(/<\?!=\s*(\w+)\s*\?>/g, (match, key) => {
        return data[key] || "";
    });

    // T·ª± ƒë·ªông in khi c√≥ tham s·ªë 'print'
    if (params.has('print')) {
        window.addEventListener('load', () => {
            window.print();
        });
    }
</script>
